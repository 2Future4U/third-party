---


copyright:
  years: 2018
lastupdated: "2018-07-03"


---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:codeblock: .codeblock}
{:pre: .pre}
{:screen: .screen}
{:tip: .tip}
{:download: .download}

# ステップ 2: リソース管理コンソールでのオファリングの定義

リソース管理コンソールは、第三者オファリングを {{site.data.keyword.Bluemix_notm}} カタログに提供する過程を支援する Web ベースのツールです。

統合請求サービスの提供が承認されたため、リソース管理コンソールに移動して、登録、オファリング開発の開始、料金プランの指定を行えます。
   1. リソース管理コンソールにサービスを登録し、*「サマリー」*ページを確認します。
   2. *「オファリング (Offering)」*ページでカタログ・メタデータを入力します。
   3. {{site.data.keyword.Bluemix_notm}} Identity and Access Management (IAM) にオファリングを登録します。サービスの認証に使用されるクライアント ID とサービス ID の資格情報が、登録で生成されます。
   4. {{site.data.keyword.Bluemix_notm}} のサービス・オファリングで適切な料金プランが顧客に提供されるように、*「料金」*ページに入力します。定義するプランには、重要な使用量詳細を提供する計量も含まれます。
   5. オファリング・メタデータを JSON 形式にエクスポートします。


## 始める前に

このステップでは、ユーザーが統合請求サービスを提供することを承認済みであると想定しています。Provider Workbench での初期登録と承認がまだ完了していない場合は、[入門チュートリアル](/docs/third-party/index.html)を参照してください。
{: tip}

1. [ステップ 1: サービス文書とマーケティング発表の作成 (PWB)](/docs/third-party/cis1-docs-marketing.html) の作業を必ず開始しておいてください。
2. {{site.data.keyword.Bluemix_notm}} に登録済みであることを確認します。そうでない場合は、[登録](https://console.bluemix.net/registration)してから先に進んでください。
3. リソース管理コンソールでの作業の開始時に正しいアカウントを使用していることを確認します。
4. {{site.data.keyword.Bluemix_notm}} サービス名を準備します。

   {{site.data.keyword.Bluemix_notm}} プラットフォームがサービスの識別に使用するサービス名と、{{site.data.keyword.Bluemix_notm}} カタログで顧客に表示される表示名の両方を指定する必要があります。

  リソース管理コンソールにオファリングを登録する際には、{{site.data.keyword.Bluemix_notm}} サービス名を準備してください。サービス名は表示名ではありません。サービス名は、以下の規則に従っていなければなりません。
   - すべて小文字でなければなりません
   - スペースは含められませんが、ハイフン (`-`) は含められます
   - 32 文字未満でなければなりません

   サービス名には、お客様の会社名を含めてください。お客様の会社が複数のオファリングを提供する場合は、サービス名の中に、会社とオファリングの両方を含めてください。例えば、Compose 社が、Redis と Elasticsearch のオファリングを提供しているとします。これらのオファリングに対する {{site.data.keyword.Bluemix_notm}} でのサービス名は、例えば、`compose-redis` と `compose-elasticsearch` になります。これら 2 つのサービス名に対して、{{site.data.keyword.Bluemix_notm}} カタログで表示される表示名 *Compose Redis* と *Compose Elasticsearch* が関連付けられています。別の FastJetMail という会社が JetMail という 1 つだけのオファリングを提供する場合は、サービス名は `fastjetmail` になります。

## オファリングの登録

始めに、ログインしてオファリングを登録します。

1. {{site.data.keyword.Bluemix_notm}} ([https://console.bluemix.net](https://console.bluemix.net){: new_window} ![外部リンク・アイコン](../icons/launch-glyph.svg "外部リンク・アイコン") ) に {{site.data.keyword.Bluemix_notm}} ID でログインします。
   **警告**: 正しい {{site.data.keyword.Bluemix_notm}} アカウントを使用することが重要です。アカウントを複数お持ちの場合、適切なアカウントに必ず切り替えてください。
2. リソース管理コンソール・ダッシュボード ([https://console.bluemix.net/onboarding/dashboard](https://console.bluemix.net/onboarding/dashboard){: new_window} ![外部リンク・アイコン](../icons/launch-glyph.svg "外部リンク・アイコン") ) に移動します。
3. **「新規リソース (New Resource)」**をクリックしてリソースを追加します。
4. **「リソース名」**を追加します。この値は、前のセクションで導出した固有の {{site.data.keyword.Bluemix_notm}} サービス名です。
5. この時点で、既存のホストされたサービス・ブローカーは必要ありません。**「ブローカーをインポートする準備はできていますか? (Is your broker ready for import?)」**フィールドには**「いいえ」**を選択します。後のステップでブローカー作成の一連の手順を説明します。ブローカーが開発されてホストされたら、リソース管理コンソールに戻って、それをインポートします。
7. サブミットすると、**「サマリー」**ページに進みます。追加の*必須*値を入力して、**「保存」**をクリックします。

行った作業をリソース管理コンソールに保存し、後で戻って情報を追加することができます。リソース管理コンソールは、サービスのライフサイクルの管理を支援するように設計されています。そのため、今すぐすべてのフィールドに答えを入力しなくても構いません。
{: tip}

## オファリング・メタデータの入力

**「オファリング (Offering)」**ページで、{{site.data.keyword.Bluemix_notm}} カタログに保管されるメタデータ値を指定します。さらに、一部の値は、エクスポートしてサービス・ブローカーに保管する必要があります。サービス・ブローカーではそれらがプロビジョニングに使用され、`カタログ (GET)` 応答の一部として戻されます。これらの値を使用して、後のステップでサービス・ブローカーの開発を円滑に開始できます。

1. リソース管理コンソールから、**「オファリング (Offering)」**ページをクリックし、**「リスト・ページ (Listing Page)」**タブをクリックします。**「リスト・ページ (Listing Page)」**では、{{site.data.keyword.Bluemix_notm}} オファリングのサービス・ダッシュボードに表示されるメタデータを定義します。すべての必須値を入力して**「保存」**をクリックします。リソース管理コンソールは、{{site.data.keyword.Bluemix_notm}} Identity and Access Management (IAM) へのサービスの初期登録を行います。サービスが IAM に登録されたことを示す通知が表示されます。後で、IAM についてさらに作業を行います。
2. 「オファリング (Offering)」ページから、**「設定」**タブをクリックします。
   1. オファリングで**「プラン変更のサポート (Plan changes supported?)」**を許可するかどうかを指定します。デフォルトは**「いいえ」**です。**「はい」**を指定する場合は、プロビジョン済みインスタンスのプラン変更をサポートするように Open Service Broker を拡張する必要があります。オファリングで複数のプランがサポートされていて、ユーザーが既存のプロビジョン済みインスタンスのプランを変更できるようにする場合は、ユーザーが自分のサービス・インスタンスを更新できるようにする必要があります。詳しくは、[Open Service Broker API v2.12](https://github.com/openservicebrokerapi/servicebroker/blob/v2.12/spec.md#updating-a-service-instance){: new_window} ![外部リンク・アイコン](../icons/launch-glyph.svg "外部リンク・アイコン") で `/v2/service_instances/{instance_id} PATCH` のエンドポイントを参照してください。
   2. サービスを**「バインド可能」**にするかどうかを指定します。デフォルトは**「いいえ」**です。サービスを {{site.data.keyword.Bluemix_notm}} 内のアプリケーションにバインドできる場合は、**「はい」**を選択します。バインド可能の場合は、API エンドポイントと資格情報をサービス・コンシューマーに戻せなければなりません。バインド可能なサービスを開発する際には、[Open Service Broker API v2.12 のバインド可能な操作](https://github.com/openservicebrokerapi/servicebroker/blob/v2.12/spec.md#binding){: new_window} ![外部リンク・アイコン](../icons/launch-glyph.svg "外部リンク・アイコン") を使用してください。
   3. その他の必須フィールドを入力し、**「保存」**をクリックします。
3. 「オファリング (Offering)」ページのナビゲーションに、このページを完成するための最小要件を満たしたことを示すチェック・マークが示されているはずです。このページが不完全とマークされている場合は、ページを再度開いて、不完全な*必須* フィールドがあるかチェックしてください。

最初のオファリング・レターに、Provider Workbench で生成されたサービス文書 URL が含まれています。その URL を**「文書 URL (Documentation URL)」**フィールドと**「手順 URL (Instructions URL)」**フィールドに入力してください
{: tip}

## IAM への登録

{{site.data.keyword.Bluemix_notm}} にオンボードするすべてのサービスに、IAM が必要です。IAM の概念と要件の詳細については、[IAM とは?](/docs/iam/index.html#what-is-cloud-iam-) を参照してください。

リソース管理コンソールは、以下の IAM 値を生成します。
   - サービス ID (生成され、保管されます)
   - API キー (生成されますが、保管されません。1 回表示されます)
   - クライアント ID (生成され、保管されます)
   - クライアント秘密鍵 (生成されますが、保管されません)

サービス・プロバイダーは、以下を提供する必要があります。
   - リダイレクト URI (OSB の開発を完了した後に、リソース管理コンソールに戻ります。ホストされたサービス・ブローカーのロケーションからリダイレクト URI を導出できます)

1. リソース管理コンソールから、**「アクセス管理 (Access Management)」**ページをクリックします。
2. **「IAM の有効化 (Enable IAM)」**をクリックします。リソース管理コンソールは、サービスを IAM に登録し、サービス ID とポリシーを作成し、API キーを作成します。さらに、完全ではないクライアント ID とクライアント秘密鍵を作成します。クライアント ID は、取得後にリダイレクト URI で更新する必要があります。
3. **「状況」**をクリックして、IAM 有効化の現行状態を確認します。

**注**: 後で IAM ページに戻って、`リダイレクト URI` を指定する必要があります。さらに開発を行って認証フローを構築するまで、この値は入手できません。後続のステップでリダイレクト URI 値の判別方法を説明します。

**IAM を有効化**すると、API キーが付与されます。API キーは必ず保存してください。この値は、二度と表示されません。API キーを紛失した場合は、キーを削除して新規に作成できます ([サービス ID の API キーの管理 (Manage service ID API keys)](/docs/iam/serviceid_keys.html#serviceidapikeys) を参照)。
{: tip}

## 料金プランの開発

{{site.data.keyword.Bluemix_notm}} にサービスをオンボードする際には、料金プランを定義する必要があります。サービスに関するユーザーへの課金方法について詳細知識がある場合には、プランでその情報を指定することができます。しかし、まだ有料プランを固めていなければ、まず、無料プランを有効にして始めて、後で戻って有料プランをセットアップすることができます。

1. リソース管理コンソールから、**「料金」**ページをクリックします。
2. **「プランの追加 (Add plan)」**をクリックして新しいプラン項目を作成し、**「プランの編集 (Edit plan)」**をクリックしてプランを編集します。
   * **無料プラン**: すべてのオファリングは、無料のライト・プランを 1 つ提供できます。これにより、ユーザーがサービスを試すことができます。無料プランは、**「表示名 (Display Name)」**に*ライト*、**「プログラム名 (Programmatic Name)」**に *lite* を使用します。**「このプランは無料ですか? (Is this plan free?)」**に**「はい」**を指定します。**「保存」**をクリックします。 プランが {{site.data.keyword.Bluemix_notm}} カタログに公開されます。
   * **サブスクリプション・プラン**: **「このプランは無料ですか? (Is this plan free?)」**に**「いいえ」**を指定します。必要なフィールドを入力します。 デフォルトの**「料金メトリック (Pricing metrics)」**のメトリックのままにします。このデフォルト・メトリックは、一回限りの月額料金をユーザーに課金するために提供されています。**「保存」**をクリックします。 プランが {{site.data.keyword.Bluemix_notm}} カタログに公開されます。使用量を送信するサンプルの curl コマンドを保存します。
   * **従量制プラン**: **「このプランは無料ですか? (Is this plan free?)」**に**「いいえ」**を指定します。必要なフィールドを入力します。 デフォルトの**「料金メトリック (Pricing metrics)」**のサブスクリプション・メトリックを*削除*します。**「メトリックをもう 1 つ追加 (Add another metric)」**をクリックし、**「料金メトリックの追加 (Add pricing metric)」**ページの入力を完了して、**「メトリックの追加 (Add metric)」**をクリックします。**「保存」**をクリックします。 プランが {{site.data.keyword.Bluemix_notm}} カタログに公開されます。使用量を送信するサンプルの curl コマンドを保存します。適切なメトリックの選択に役立つ情報については、[計量の統合](/docs/third-party/metering.html)を参照してください。
3. **「料金」**ページに、このページを完成するための最小要件を満たしたことを示す完了のマークが示されているはずです。

サービス・プロバイダーは、すべての従量制プランについて毎時の使用量送信を自動化する必要があります。詳しくは、[従量制プランの使用量の送信 (Submitting usage for metered plans)](/docs/third-party/submitusage.html) を参照してください。
{: tip}

## メタデータを JSON としてエクスポート

リソース管理コンソールでサービスを定義したので、catalog.json ファイルをダウンロードして使用し、Open Service Broker の開発に情報を提供することができます。catalog.json には、ブローカーでホストする必要があるメタデータが含まれます。これらの値によって、ブローカーがサポートするサービスとプランについて、ブローカーと {{site.data.keyword.Bluemix_notm}} プラットフォーム間の契約が定義されます。プロビジョニングに必要でないその他のカタログ・メタデータはすべて、{{site.data.keyword.Bluemix_notm}} カタログ内に保管され、ダッシュボードのレンダリングに使用されるカタログ表示値 (リンク、アイコン、国際化対応翻訳メタデータなど) への更新は、ブローカー内に収容されるのではなく、リソース管理コンソールで更新される必要があります。ブローカーに保管されたメタデータは、{{site.data.keyword.Bluemix_notm}} コンソールでも {{site.data.keyword.Bluemix_notm}} CLI でも表示されません。コンソールと CLI は、リソース管理コンソール内で設定され、{{site.data.keyword.Bluemix_notm}} カタログに保管されたものを戻します。

1. リソース管理コンソールから、**「デプロイメント (Deployments)」**ページを開きます。
2. **「管理」**をクリックします。 
3. **「定義のダウンロード (Download Definitions)」**をクリックします。

`catalog.json` ファイルを保存します。これを使用して、次のセクションで Open Service Broker を開発します。

## 次のステップ

順調です。カタログ表示メタデータを追加し、IAM に登録し、1 つ以上の料金プランを作成して、サービス・オファリングを定義しました。次に、エクスポートされた JSON を使用して、サービス・ブローカーの開発を始めます。[ステップ 3: サービス・ブローカーの開発とホスティング](/docs/third-party/cis3-broker.html)を参照してください。
