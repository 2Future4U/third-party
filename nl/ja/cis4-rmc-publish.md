---


copyright:
  years: 2018, 2019 
lastupdated: "2019-01-30"


---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:codeblock: .codeblock}
{:pre: .pre}
{:screen: .screen}
{:tip: .tip}
{:download: .download}

# ステップ 5. サービスの公開およびテスト
{: #step5-pubtest}

OSB 仕様に適合した 1 つ以上のブローカーをホストしたので、リソース管理コンソールに戻って {{site.data.keyword.Bluemix_notm}} カタログにサービスを公開することができます。 
{:shortdesc}

## 始める前に
{: #service-pre-reqs}

このステップは、ユーザーが統合請求サービスを提供することを承認済みであると想定しています。 Provider Workbench での初期登録と承認がまだ完了していない場合は、[入門チュートリアル](/docs/third-party/index.md?topic=third-party-get-started#get-started)を参照してください。
{: tip}

ステップ 1 を開始しており、ステップ 2、3、および 4 を完了していることを確認してください。
1. [サービス文書とマーケティング発表を作成する](/docs/third-party?topic=third-party-content-tasks#content-tasks)。
2. [リソース管理コンソールでオファリングを定義する](/docs/third-party?topic=third-party-step2-define#step2-define)。
3. [サービス・ブローカーを作成してホストする](/docs/third-party?topic=third-party-step3-osb#step3-osb)。
3. [認証フローを作成する](/docs/third-party?topic=third-party-step4-iam#step4-iam)。

## {{site.data.keyword.Bluemix_notm}} へのサービスの公開
{: #publish}

1. リソース管理コンソールから、**「デプロイメント (Deployments)」**ページをクリックします。
2. **「ブローカー」**タブをクリックし、**「ブローカーの追加」**をクリックします。
3. **「管理」**をクリックして、「サービス・ブローカー構成」ページを開きます。
4. ホストされているブローカーを追加し、**「ブローカーの登録」**をクリックします。
5. 正常に登録ができたら、**「カタログ・デプロイメント」**タブに切り替えます。
6. **「デプロイメントの追加」**をクリックし、プランとデプロイするブローカーを選択します。
7. サービスをデプロイする地域とデータ・センターを選択し、**「追加」**をクリックします。
8. **「デプロイメント」**ページから、公開されていないデプロイメントをレビューし、**「公開」**をクリックします。
9. **「カタログに公開」**ページから、デプロイメントの詳細を検討し、**「公開」**をクリックします。

ナビゲーションの「デプロイメント」ページに、完了のマークが付けられ、最小要件をパスしたことを示している必要があります。

デプロイメント失敗でお困りですか? IBM 担当員に連絡して支援を要請してください。
{: tip}

## デプロイされたオファリングのテスト 
{: #publish-test}

限定表示モードでデプロイしているため、{{site.data.keyword.Bluemix_notm}} カタログでお客様のオファリングを表示できるのはお客様自身のみになります。 次のセクションのチェックリストを使用して、{{site.data.keyword.Bluemix_notm}} にログインし、テスト基準の確認作業を行ってください。

1. IBM ID で [{{site.data.keyword.Bluemix_notm}}](https://cloud.ibm.com){: new_window} ![外部リンク・アイコン](../icons/launch-glyph.svg "External linkicon") にログインします。
2. 正しいアカウント (サービスを作成するために使用したのと同じアカウント) にログインしていることを確認します。
3. ヘッダーの**「カタログ」**リンクをクリックし、ご自分のオファリングを検索します。
4. 次に、以下のチェックリストを使用してサービスを確認します。

### チェックリスト - サービスのテスト
{: #test-your-service}

1. サービス・インスタンス・ダッシュボードから認証を検証する
2. カタログが正しく表示されている (ブローカーからのインポートがリソース管理コンソールに正しく表示されている)
3. プロビジョンが機能する - 選択したプランにサービス・インスタンスを作成できる
4. プロビジョン解除が機能する - サービス・インスタンスを削除できる
5. バインドが機能する - **「接続 (Connections)」**をクリックして、サービスを別のアプリケーションに接続できる
6. アンバインドが機能する - サービスを切断し、接続を削除できる
7. サービス・キーの作成 / サービス・キーの削除 - **「資格情報 (Credentials)」**をクリックしてサービス・キーを生成し、次にそのサービス・キーを削除できる
8. 複数のプランをサポートする場合は、`plan_changeable` をテストする。 Yes を設定してこれを有効にした場合、プロビジョン済みインスタンスのプラン変更をサポートするように Open Service Broker を拡張する必要があります。 オファリングで複数のプランがサポートされていて、ユーザーがプロビジョン済みインスタンスのプランを変更する場合は、ユーザーが自分のサービス・インスタンスを更新できるようにする必要があります。 詳しくは、Open Service Broker API v2.12 - Patch - の /v2/service_instances/{instance_id} PATCH エンドポイントを参照してください。ユーザーがプロビジョン済みインスタンスのプランを変更できることを表示します。 テストするには、既存のプロビジョン済みサービス・インスタンスのプランを切り替えてください。
9. OSB 仕様は、使用不可のインスタンス状態だが、まだ削除されていないインスタンス状態をサポートしません。 請求の期限切れや、アカウント中断につながる状況 (アカウント取り消しには至らない) が発生する可能性のあるお客様をサポートするために、IBM Cloud では、サービス・インスタンスを無効化して再び有効化できる拡張 API エンドポイントを定義しています。 以下のエンドポイント拡張は**必須**です。 IBM 担当員と協力して、エンドポイントの有効化と無効化のテストを行ってください。
   - インスタンスの有効化と無効化 (GET): 状況 - サービス・インスタンスの状態を返します。
   - インスタンスの有効化と無効化 (PUT): サービス・インスタンスの有効化または無効化を可能にします。
10. 従量制プランをサポートしている場合は、使用量の送信をテストします。 課金される使用量を使用するプランについては、以下を確認する必要があります。
   - 使用量 API を curl し、使用量に基づいた正確な料金を正しく返すことができる。
   - 使用量への自動化された毎時送信を有効にして、サービスのインスタンスをプロビジョンするすべてのユーザーをサポートしていることをデモンストレーションできる。

テストが失敗した場合は、前のステップを繰り返してサービスを公開して再度テストし、成功するまで繰り返します。


## 次のステップ
{: #release}

これで、機能するサービスがカタログに掲載されたので、デモを作成し、サービスを一般公開するための承認を依頼できます。 [ステップ 6: サービスの一般公開](/docs/third-party?topic=third-party-public-releasing#public-releasing)を参照してください。
