---


copyright:
  years: 2018
lastupdated: "2018-08-21"


---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:codeblock: .codeblock}
{:pre: .pre}
{:screen: .screen}
{:tip: .tip}
{:download: .download}

# 步骤 5：发布和测试服务

现在，您已拥有满足 OSB 规范的托管代理程序，您可以返回到资源管理控制台以将服务发布到 {{site.data.keyword.Bluemix_notm}}“目录”。完成**部署**选项卡：安排将服务套餐部署到 {{site.data.keyword.Bluemix_notm}}“目录”的一个或多个区域中，测试代理程序，并最终以有限可视性方式将其发布到目录。成功部署后，测试产品以确保它满足必需条件，并根据需要通过发布过程进行迭代。


## 开始之前

此步骤假定您已获得批准交付 Integrated Billing 服务。如果您尚未完成 Provider Workbench 中的初始注册和批准，请参阅[入门教程](/docs/third-party/index.md)。
{: tip}

确保已开始执行步骤 1，并完成了步骤 2、3 和 4：
1. [编写服务文档和市场营销公告](/docs/third-party/cis1-docs-marketing.html)。
2. [在资源管理控制台中定义产品](/docs/third-party/cis2-rmc-define.html)。
3. [开发和托管服务代理程序](/docs/third-party/cis3-broker.html)。
3. [开发认证流程](/docs/third-party/cis5-iam.html)。

## 将服务发布到 {{site.data.keyword.Bluemix_notm}}

1. 在资源管理控制台中，单击“部署”页面。
2. 单击**代理程序**选项卡，然后单击**添加代理程序**。
3. 单击**管理**以打开“服务代理程序配置”页面。
4. 添加托管的代理程序，然后单击**注册代理程序**。
5. 成功注册后，切换到**目录部署**选项卡。
6. 单击**添加部署**，然后选择要部署的套餐和代理程序。
7. 选择要在其中部署服务的区域和数据中心，然后单击**添加**。
8. 在“部署”页面中，查看未发布的部署，然后单击**发布**。
9. 在“发布到目录”页面中，复查部署的详细信息，然后单击**发布**。

现在，“部署”页面应该在导航中标记为“完成”，指示您已满足最低需求。

卡在部署失败了？请联系 IBM 代表以获取帮助。
{: tip}

## 测试部署的产品 

由于您是以有限可视性方式进行部署的，因此只能在 {{site.data.keyword.Bluemix_notm}}“目录”中看到您的产品。使用下面的核对表，登录到 {{site.data.keyword.Bluemix_notm}}，并完成所有测试条件。

1. 使用 IBM 标识登录到 {{site.data.keyword.Bluemix_notm}}：[https://console.bluemix.net](https://console.bluemix.net){: new_window} ![外部链接图标](../icons/launch-glyph.svg "外部链接图标")。
2. 请确保您使用的是正确的帐户（与用于创建服务的帐户相同）。
3. 单击标题中的**目录**链接，然后搜索您的产品。
4. 接下来，使用下面的核对表来验证您的服务。

### 核对表 - 测试服务
1. 在服务实例仪表板中验证认证
2. 目录正确显示（“从代理程序导入”在资源管理控制台中正确显示）
3. 供应可正常工作 - 可以在所选套餐中创建服务实例
4. 取消供应可正常工作 - 可以删除服务实例。
5. 绑定可正常工作 - 可以单击**连接**并将服务连接到其他应用程序
6. 取消绑定可正常工作 - 可以断开与服务的连接并删除连接。
7. 创建服务密钥/删除服务密钥 - 可以单击**凭证**，生成服务密钥，然后删除该服务密钥。
8. 如果支持多个套餐，请测试 `plan_changeable`。如果通过设置“是”启用了此项，那么需要扩展 Open Service Broker 以支持所供应实例的套餐更改。如果产品支持多个套餐，并且您希望用户能够更改已供应实例的套餐，那么需要启用用户更新其服务实例的能力。有关更多详细信息，请参阅 Open Service Broker API V2.12 中的 /v2/service_instances/{instance_id} PATCH 端点 - Patch - 显示用户可以更改已供应实例的套餐。要进行测试，请在现有供应的服务实例上切换套餐。
9. OSB 规范不支持已禁用但尚未删除的实例状态。为了使 IBM Cloud 能够支持可能遇到导致帐户暂挂（但尚未取消）的计费中断或其他情况的客户，IBM Cloud 定义了扩展 API 端点，允许禁用和重新启用服务实例。以下端点扩展是**必需**的；请与 IBM 代表合作，要求他们测试您的启用和禁用端点：
   - 启用和禁用实例 (GET)：状态 - 返回服务实例的状态。
   - 启用和禁用实例 (PUT)：允许启用或禁用服务实例。
10. 如果您支持计量套餐，请测试使用量提交。对于任何使用计量使用量的套餐，必须验证以下内容：
   - 可以对使用量 API 运行 curl，并根据使用量正确返回准确的定价。
   - 可以演示已启用自动每小时提交使用量，从而支持供应服务实例的所有用户。

如果测试失败，请重复先前步骤以重新发布服务并测试，一直迭代，直到成功为止。


## 后续步骤

现在，您在目录中有正常运行的服务，您可以构建演示并要求获得批准以公开发布服务。请参阅：[步骤 6：公开发布服务](/docs/third-party/cis6-ga.html)。
